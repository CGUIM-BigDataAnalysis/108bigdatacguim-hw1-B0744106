108-2 大數據分析方法 作業一
================
李彬勤

搞不清楚各行各業的薪資差異嗎? 念研究所到底對第一份工作的薪資影響有多大? CP值高嗎? 透過分析**初任人員平均經常性薪資**-
（107年）(<https://data.gov.tw/dataset/6647>)
（104-105年）<http://ipgod.nchc.org.tw/dataset/a17000000j-020066>
，可初步了解台灣近幾年各行各業、各學歷的起薪。

## 比較104年度和107年度大學畢業者的薪資資料

### 資料匯入與處理

``` r
library(readr)
library(dplyr)
```

    ## 
    ## Attaching package: 'dplyr'

    ## The following objects are masked from 'package:stats':
    ## 
    ##     filter, lag

    ## The following objects are masked from 'package:base':
    ## 
    ##     intersect, setdiff, setequal, union

``` r
x104 <- read_csv("C:/Users/User/Downloads/a.csv")
```

    ## Parsed with column specification:
    ## cols(
    ##   年度 = col_double(),
    ##   大職業別 = col_character(),
    ##   `經常性薪資-薪資` = col_double(),
    ##   `經常性薪資-女/男` = col_character(),
    ##   `國中及以下-薪資` = col_character(),
    ##   `國中及以下-女/男` = col_character(),
    ##   `高中或高職-薪資` = col_character(),
    ##   `高中或高職-女/男` = col_character(),
    ##   `專科-薪資` = col_character(),
    ##   `專科-女/男` = col_character(),
    ##   `大學-薪資` = col_character(),
    ##   `大學-女/男` = col_character(),
    ##   `研究所及以上-薪資` = col_character(),
    ##   `研究所及以上-女/男` = col_character()
    ## )

``` r
X107 <- read_csv("C:/Users/User/Downloads/107-career.csv")
```

    ## Parsed with column specification:
    ## cols(
    ##   年度 = col_double(),
    ##   大職業別 = col_character(),
    ##   `經常性薪資-薪資` = col_character(),
    ##   `經常性薪資-女/男` = col_character(),
    ##   `國中及以下-薪資` = col_character(),
    ##   `國中及以下-女/男` = col_character(),
    ##   `高中或高職-薪資` = col_character(),
    ##   `高中或高職-女/男` = col_character(),
    ##   `專科-薪資` = col_character(),
    ##   `專科-女/男` = col_character(),
    ##   `大學-薪資` = col_character(),
    ##   `大學-女/男` = col_character(),
    ##   `研究所-薪資` = col_character(),
    ##   `研究所-女/男` = col_character()
    ## )

``` r
x104$`大職業別`<-gsub("部門|、","",x104$`大職業別`)
X107$`大職業別`<-gsub("_","",X107$`大職業別`)
X107$`大職業別`<-gsub("建工程","造業",X107$`大職業別`)
X107$`大職業別`<-gsub("出版、影音製作、傳播及資通訊服務業","資訊及通訊傳播業",X107$`大職業別`)
X107$`大職業別`<-gsub("教育業","教育服務業",X107$`大職業別`)
X107$`大職業別`<-gsub("醫療保健業","醫療保健服務業",X107$`大職業別`)

x104$`大學-薪資`<-as.numeric(gsub("—|…",NA,x104$`大學-薪資`))
X107$`大學-薪資`<-as.numeric(gsub("—|…",NA,X107$`大學-薪資`))



Compare<-(inner_join(x104,X107,by="大職業別"))
```

### 107年度薪資較104年度薪資高的職業有哪些?

``` r
#這是R Code Chunk
salary<-select(X107,`大職業別`)
salary$salaryrate<-((X107$`大學-薪資`)/(x104$`大學-薪資`))

salary<-salary[complete.cases(salary$salaryrate),]
highsalaryrate<-arrange(salary,desc(salaryrate))

head(highsalaryrate,10)
```

    ## # A tibble: 10 x 2
    ##    大職業別                                salaryrate
    ##    <chr>                                        <dbl>
    ##  1 專業科學及技術服務業-服務及銷售工作人員       1.16
    ##  2 教育服務業-服務及銷售工作人員                 1.13
    ##  3 不動產業-技術員及助理專業人員                 1.13
    ##  4 住宿及餐飲業-服務及銷售工作人員               1.11
    ##  5 藝術娛樂及休閒服務業-事務支援人員             1.10
    ##  6 金融及保險業-技藝機械設備操作及組裝人員       1.10
    ##  7 教育服務業                                    1.10
    ##  8 教育服務業-事務支援人員                       1.10
    ##  9 用水供應及污染整治業-專業人員                 1.09
    ## 10 教育服務業-專業人員                           1.09

以上十筆資料是107年度薪資比104年度薪資藥膏的大職業別，我們可以用salaryrate來判斷，因為分子為107年的大學薪資，而分母為104年的大學薪資，因此salaryrate大於一就可以知道那些職業107年的薪資比104年要多。

### 提高超過5%的的職業有哪些?

``` r
#這是R Code Chunk
salary<-select(X107,`大職業別`)
salary$salaryrate<-((X107$`大學-薪資`)/(x104$`大學-薪資`))

salary<-salary[complete.cases(salary$salaryrate),]
rate<-filter( salary , salaryrate > 1.05 )

highsalaryrate<-arrange(rate,desc(salaryrate))

highsalaryrate
```

    ## # A tibble: 53 x 2
    ##    大職業別                                salaryrate
    ##    <chr>                                        <dbl>
    ##  1 專業科學及技術服務業-服務及銷售工作人員       1.16
    ##  2 教育服務業-服務及銷售工作人員                 1.13
    ##  3 不動產業-技術員及助理專業人員                 1.13
    ##  4 住宿及餐飲業-服務及銷售工作人員               1.11
    ##  5 藝術娛樂及休閒服務業-事務支援人員             1.10
    ##  6 金融及保險業-技藝機械設備操作及組裝人員       1.10
    ##  7 教育服務業                                    1.10
    ##  8 教育服務業-事務支援人員                       1.10
    ##  9 用水供應及污染整治業-專業人員                 1.09
    ## 10 教育服務業-專業人員                           1.09
    ## # ... with 43 more rows

### 主要的職業種別是哪些種類呢?

``` r
#這是R Code Chunk
table(sapply( (strsplit (salary$`大職業別`,"-") ), "[" ,  1))%>%
  View()
```

## 男女同工不同酬現況分析

男女同工不同酬一直是性別平等中很重要的問題，分析資料來源為104到107年度的大學畢業薪資。

### 104和107年度的大學畢業薪資資料，哪些行業男生薪資比女生薪資多?

``` r
#這是R Code Chunk
x104$`大學-女/男`<-as.numeric(gsub("—|…",NA,x104$`大學-女/男`))
a104<-x104[complete.cases(x104$`大學-女/男`),]
a104<-select(a104,`大職業別`,`大學-女/男`)
a104<-a104[order(a104$`大學-女/男`,decreasing = T),]


X107$`大學-女/男`<-as.numeric(gsub("—|…",NA,X107$`大學-女/男`))
b107<-X107[complete.cases(X107$`大學-女/男`),]
b107<-select(b107,`大職業別`,`大學-女/男`)
b107<-b107[order(b107$`大學-女/男`,decreasing = T),]


a104$`大學-女/男`<-as.character(a104$`大學-女/男`)
b107$`大學-女/男`<-as.character(b107$`大學-女/男`)

tail(a104,10)
```

    ## # A tibble: 10 x 2
    ##    大職業別                                        `大學-女/男`
    ##    <chr>                                           <chr>       
    ##  1 教育服務業                                      96.44       
    ##  2 營造業                                          96.35       
    ##  3 用水供應及污染整治業-技藝機械設備操作及組裝人員 95.9        
    ##  4 營造業-技藝機械設備操作及組裝人員               95.64       
    ##  5 其他服務業-事務支援人員                         95.47       
    ##  6 礦業及土石採取業                                95.28       
    ##  7 礦業及土石採取業-技藝機械設備操作及組裝人員     93.1        
    ##  8 礦業及土石採取業-技術員及助理專業人員           92.42       
    ##  9 教育服務業-服務及銷售工作人員                   91.9        
    ## 10 電力及燃氣供應業-技藝機械設備操作及組裝人員     91.69

``` r
tail(b107,10)
```

    ## # A tibble: 10 x 2
    ##    大職業別                                `大學-女/男`
    ##    <chr>                                   <chr>       
    ##  1 營造業-事務支援人員                     98.23       
    ##  2 用水供應及污染整治業-服務及銷售工作人員 97.94       
    ##  3 用水供應及污染整治業-專業人員           97.81       
    ##  4 營造業-技術員及助理專業人員             97.78       
    ##  5 電力及燃氣供應業-服務及銷售工作人員     97.73       
    ##  6 教育服務業-事務支援人員                 97.61       
    ##  7 營造業                                  97.52       
    ##  8 礦業及土石採取業                        97.11       
    ##  9 電力及燃氣供應業-事務支援人員           96.96       
    ## 10 礦業及土石採取業-專業人員               96.02

上面的資料為男女薪資比例大小由小到大排序的前十名職業，第一張圖是104年薪資比例的前十名，從比例可以知道，女生在分子，而比例都沒有大於一，所以可以看到這十個行業的男生薪資都比女生還要多，第二張圖是107年薪資比例的前十名，同理可以知道這十個大職業別的薪資都是男生的薪資大於女生的薪資。
\#\#\# 哪些行業女生薪資比男生薪資多?

``` r
head(a104,10)
```

    ## # A tibble: 10 x 2
    ##    大職業別                                        `大學-女/男`
    ##    <chr>                                           <chr>       
    ##  1 專業科學及技術服務業-技藝機械設備操作及組裝人員 100.26      
    ##  2 用水供應及污染整治業-服務及銷售工作人員         100         
    ##  3 不動產業-技藝機械設備操作及組裝人員             100         
    ##  4 醫療保健服務業-服務及銷售工作人員               100         
    ##  5 其他服務業-專業人員                             100         
    ##  6 住宿及餐飲業-技術員及助理專業人員               99.93       
    ##  7 支援服務業-技術員及助理專業人員                 99.92       
    ##  8 住宿及餐飲業-服務及銷售工作人員                 99.9        
    ##  9 用水供應及污染整治業-技術員及助理專業人員       99.78       
    ## 10 運輸及倉儲業-技藝機械設備操作及組裝人員         99.76

``` r
head(b107,10)
```

    ## # A tibble: 10 x 2
    ##    大職業別                                    `大學-女/男`
    ##    <chr>                                       <chr>       
    ##  1 礦業及土石採取業-技藝機械設備操作及組裝人員 100         
    ##  2 資訊及通訊傳播業-技藝機械設備操作及組裝人員 100         
    ##  3 金融及保險業-服務及銷售工作人員             100         
    ##  4 金融及保險業-技藝機械設備操作及組裝人員     100         
    ##  5 不動產業-服務及銷售工作人員                 100         
    ##  6 不動產業-技藝機械設備操作及組裝人員         100         
    ##  7 專業科學及技術服務業-服務及銷售工作人員     100         
    ##  8 教育服務業-服務及銷售工作人員               100         
    ##  9 電力及燃氣供應業-技藝機械設備操作及組裝人員 99.98       
    ## 10 金融及保險業-專業人員                       99.96

上面的資料為男女薪資比例大小由小到大排序的前十名職業，第一張圖是104年薪資比例的前十名，女生在分子，從比例可以知道專業科學及技術及服務業-記憶機械設備
\#\# 研究所薪資差異

以107年度的資料來看，哪個職業別念研究所最划算呢 (研究所學歷薪資與大學學歷薪資增加比例最多)?

``` r
#這是R Code Chunk
X107$`研究所-薪資`<-as.numeric(gsub("—|…",NA,X107$`研究所-薪資`))
X107$`大學-薪資`<-as.numeric(gsub("—|…",NA,X107$`大學-薪資`))

dataset <- data.frame(name = X107$`大職業別`)
dataset$salaryrate<-X107$`研究所-薪資`/X107$`大學-薪資`

dataset<-dataset[complete.cases(dataset$salaryrate),]
dataseta<-dataset[order(dataset$salaryrate,decreasing = T),]

head(dataseta,10)
```

    ##                              name salaryrate
    ## 134                    其他服務業   1.237694
    ## 99           專業科學及技術服務業   1.205362
    ## 100 專業科學及技術服務業-專業人員   1.204652
    ## 116       教育服務業-事務支援人員   1.189864
    ## 78               資訊及通訊傳播業   1.183921
    ## 137       其他服務業-事務支援人員   1.180548
    ## 79      資訊及通訊傳播業-專業人員   1.179958
    ## 22                         製造業   1.178580
    ## 8                            工業   1.174801
    ## 1                    工業及服務業   1.174391

## 我有興趣的職業別薪資狀況分析

### 有興趣的職業別篩選，呈現薪資

``` r
#這是R Code Chunk
dataset2 <- data.frame(name = X107$`大職業別`,
                           `研究所` =X107$`研究所-薪資`,
                           `大學` = X107$`大學-薪資`)

dataset2<-dataset2[complete.cases(dataset2$`研究所`&dataset2$`大學`),]
dataset2$`研究所`<-sort(dataset2$`研究所`,decreasing = T)

dataset2[grep("資訊及通訊傳播業-專業人員|資訊及通訊傳播業",dataset$name),]
```

    ##                                     name 研究所  大學
    ## 78                      資訊及通訊傳播業  32206 29143
    ## 79             資訊及通訊傳播業-專業人員  32201 31763
    ## 80 資訊及通訊傳播業-技術員及助理專業人員  32103 28910
    ## 81         資訊及通訊傳播業-事務支援人員  32049 27464

``` r
head(dataset2[grep("資訊及通訊傳播業-專業人員|資訊及通訊傳播業",dataset2$name),],10)
```

    ##                                     name 研究所  大學
    ## 78                      資訊及通訊傳播業  32206 29143
    ## 79             資訊及通訊傳播業-專業人員  32201 31763
    ## 80 資訊及通訊傳播業-技術員及助理專業人員  32103 28910
    ## 81         資訊及通訊傳播業-事務支援人員  32049 27464

### 這些職業別研究所薪資與大學薪資差多少呢？

``` r
#這是R Code Chunk
dataset2$rate<-dataset2$`研究所`/dataset2$`大學`
head(dataset2[grep("資訊及通訊傳播業-專業人員|資訊及通訊傳播業",dataset2$name),],10)
```

    ##                                     name 研究所  大學     rate
    ## 78                      資訊及通訊傳播業  32206 29143 1.105102
    ## 79             資訊及通訊傳播業-專業人員  32201 31763 1.013790
    ## 80 資訊及通訊傳播業-技術員及助理專業人員  32103 28910 1.110446
    ## 81         資訊及通訊傳播業-事務支援人員  32049 27464 1.166946
